!function(c){c.fn.serializeObject=function(){"use strict";var n={};return c.each(this.serializeArray(),function(e,t){var a=n[t.name];null!=a?c.isArray(a)?a.push(t.value):n[t.name]=[a,t.value]:n[t.name]=t.value}),n};window.C4gPn=new function(){function s(a,t,n){t=t||{},n=n||"";var s=480,i=360,o=[{text:C4GLANG.close,icons:{primary:"ui-icon-close"},click:function(){c(this).dialog("close"),c("#modal-"+a).remove()}}];"compose"==a&&(s=480,i=360,o.unshift({text:C4GLANG.send,icons:{primary:"ui-icon-arrowreturnthick-1-w"},click:function(){c("#frmCompose").submit()}})),"view"==a&&(s=480,i=360,o.unshift({text:C4GLANG.delete,icons:{primary:"ui-icon-trash"},click:function(){e(t.id),c(this).dialog("close")}}),o.unshift({text:C4GLANG.reply,icons:{primary:"ui-icon-arrowreturnthick-1-w"},click:function(){var e="RE: "+c(".subject").text();r(t.sid,e,e,this),c(this).dialog("close")}})),c.ajax({method:"GET",url:pnApiBaseUrl+"/modal/"+a,data:{data:t},success:function(e){c("#modal-"+a).remove(),c("body").append(e.template),c("#modal-"+a).dialog({title:n,minWidth:s,minHeight:i,close:function(e,t){c("#modal-"+a).remove()},buttons:o});e=document.getElementById("frmCompose");null!=e&&(e.dataset.target=t.target)}})}var e=function(t){1==confirm(C4GLANG.delete_confirm)&&c.ajax({method:"DELETE",url:pnApiBaseUrl+"/delete/"+t,success:function(e){1==e.success&&c("#message-"+t).remove()}})},r=function(e,t,a,n){"undefined"!=typeof event&&event.preventDefault(),a=a||"",s("compose",{recipient_id:e,subject:t=t||"",target:n.getAttribute("data-target")},a)};return{sendMessage:function(e){var t=c(e).serializeObject();t.target=e.dataset.target,c.ajax({method:"POST",url:pnApiBaseUrl+"/send",data:t,success:function(e){!0!==e.success?alert(C4GLANG.send_error):c("#modal-compose").dialog("close")}})},sendMessageTo:r,deleteMessage:e,openModal:s,parseHTMLCode:function(e){var t=document.createElement("div");t.innerHTML=c(e).html(),c(e).html(c(t).text())},markAsRead:function(t){c.ajax({method:"POST",url:pnApiBaseUrl+"/mark",data:{status:1,id:t},success:function(e){!0!==e.success?alert(e.message):c("#message-"+t+".unread").removeClass("unread").addClass("read")}})}}}}(jQuery);